---
layout: post
title: "Introducing crsh: a Javascript based command line shell"
date:   2020-07-12 13:27:00 +0000
tags: technology shell programming javascript
---
Existing shells generally operate with their own somewhat archaic syntax,
continuous with the underlying operating system and set of historical design choices.

This puts the majority of shell syntax just out of reach for a very large subset of command line users who use the command line for little more than launching one or two command line tools, navigating directories, and maybe ocassionally piping commands or outputting them to files. These users will usually write scripts in a language more familiar to them as soon as things get a little trickier (because the value of learning the control flow syntax in `bash`, `zsh`, or `fish` does not seem like time well spent).

This is not a criticism of those shells, exactly. But it does highlight a potential space for new shells that can better fulfill the needs of these users. Conversely, if you are an experienced bash shell scripter, and terms like "file descriptors" and `SIGCHLD` mean something to you, you will probably dislike my approach here. But please feel free to stick around and provide some advice.

## Enter crsh

I've started work on a shell that can seamlessly interoperate Javascript syntax (and in fact works by `eval`ing JS in the Deno runtime) and traditional shell execution.

Regular command execution will be familiar to those who have used the command line:

```
$ ls | grep .js
builtins.js
dsh.js
functions.js
```

And inline anonymous functions will be familiar to those who have used Javascript:

```js
$ () => "Hello world!"
Hello world!
```

Returning a list from an inline function will be outputted as separate lines:


```js
$ () => new Array(5).fill().map((line, index) => `Line ${index}`)
Line 0
Line 1
Line 2
Line 3
Line 4
```

Combining these concepts can yield a very expressive shell:

```js
$ ls | ({ lines }) => lines.map((line, index) => `line ${index}: ${line}`) | grep line 3
line 3: functions.js
```
